<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%>
<%@ include file="/WEB-INF/jsp/common/includes.jsp" %>
<%@ page import="javax.servlet.http.*"%>
<%@ page import="javax.servlet.*"%>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
	   	<title>建设工程项目物资管理平台</title>
	   	<meta charset="utf-8">
		<meta http-equiv="pragma" content="no-cache">
		<meta http-equiv="cache-control" content="no-cache">
		<meta http-equiv="expires" content="0">  
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
		<link rel="stylesheet" href="${emms}/css/bootstrap/bootstrap.min.css">
		<style type="text/css">
		@font-face{
			font-family:'Glyphicons Halflings';
			src:url('../fonts/glyphicons-halflings-regular.eot');
			src:url('../fonts/glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'),url('../fonts/glyphicons-halflings-regular.woff') format('woff'),url('../fonts/glyphicons-halflings-regular.ttf') format('truetype'),url('../fonts/glyphicons-halflings-regular.svg#glyphicons-halflingsregular') format('svg')
		}
		</style>
	   	<link rel="stylesheet" href="${emms}/css/main.css">
	   	<link href="${emms}/css/jqueryslide/slide-unlock.css" rel="stylesheet">
	</head>
  
	<body onload="checkParent();">
	<!-- 
		<div class="container">
  			<img alt="" src="${emms}/images/logo.png" class="img-rounded img-responsive" style="margin-top: 17px;margin-left: 40px;">
			<div class="row">
				<div class="col-md-8"></div>
			  	<div class="col-md-4">
			  		<div class="form-horizontal log" style="height: 30px;width:360px;margin-bottom: 25px;color: #4C4C4C">
			  			<img alt="" src="${emms}/images/loginhead.png" class="img-rounded img-responsive" style="margin-top: 17px;margin-left: -60px;">
					</div>
			  		<form class="form-horizontal" id="login" method="post" action="${emms}/<c:url value='j_spring_security_check'/>">
			  			<div class="form-group " id="fg_username">
					   		<div class="input-group col-md-6"  style="width: 200px;">
					      		<div class="input-group-addon" style="border-color: #1F5D86;"><span class="glyphicon glyphicon-user"></span></div>
					      		<input type="text" class="form-control" id="username" name="username" placeholder="用户名"  style="border-color: #1F5D86;width: 180px;">
					    	</div>
						</div>
						<div class="form-group " id="fg_password">
							<div class="input-group col-md-6"  style="width: 200px;">
					      		<div class="input-group-addon" style="border-color: #1F5D86;"><span class="glyphicon glyphicon-lock"></span></div>
					      		<input type="password" class="form-control" id="password" name="password" placeholder="密码"  style="border-color: #1F5D86;width: 180px;">
					    	</div>
						</div>
						
						<div class="form-group" >
							<button type="button" class="loginButton" id="checkLogin" style="width: 220px;border: 0px">登&nbsp;&nbsp;录</button>
						 	<c:choose>
							 	<c:when test="${SPRING_SECURITY_LAST_EXCEPTION.message == 'Bad credentials'}">
									<span style="color: red;">密码错误</span>
								</c:when>
						 		<c:otherwise>
						 			<span style="color: red;">${SPRING_SECURITY_LAST_EXCEPTION.message}</span>
						 		</c:otherwise>
						 	</c:choose>
						</div>	
					</form>
			  	</div>
			</div>
		</div>	
		 -->
		 
		<div class="container main" style="padding: 0px; margin: 0px;">
        <div class="row login_content">
            <div class="col-md-6 left_img">
                <img src="${emms}/images/logoNew.png" alt="">
            </div>
            <div class="col-md-6 right_form">
                <form class="form-horizontal" role="form" id="login" method="post" action="${emms}/jsp/loginSuccess.do">
                    <div class="form-group col-md-12">
                        <label for="userName" class="col-md-3 control-label"> 用户名：</label>
                        <span class="col-md-6">
                            <input type="text" class="form-control col-md-12" id="username" name="username" id="userName">
                        </span>
                        <span class="col-md-3"></span>
                    </div>
                    <div class="form-group col-md-12">
                        <label for="password" class="col-md-3 control-label">密码：</label>
                        <span class="col-md-6">
                            <input type="password" class="form-control col-md-12" id="password" name="password" id="password" >
                        </span>
                    </div>
                    <!-- 
                    <div class="form-group col-md-12">
                        <label for="code" class="col-md-3 control-label">验证码：</label>
                        <span class="col-md-3">
                            <input type="text" class="form-control" id="code" >
                        </span>
                        <span class="code col-md-3" id="code_value"></span>
                        <span class="col-md-3">
                           <a href="#" id="change_code" onclick="createCode()">更换验证码</a>
                        </span>
                    </div>
                     -->

                    <div id="sliderdiv" class="form-group col-md-12" style="display: none">
						<%--<label class="col-md-3 control-label"></label>
                        <span class="col-md-6">
                        <div id="slider">
                            <div id="slider_bg"></div>
                            <span id="label">>></span> <span id="labelTip">拖动滑块验证登陆</span>
                        </div>
						</span>--%>
						<script src="${emms}/js/jquery.min.js" type="text/javascript"></script>
						<script src="${emms}/js/jquery.slideunlock.js"></script>
						<script>
						    $(function () {
						        var slider = new SliderUnlock("#slider",{
										successLabelTip : "欢迎登陆"	
									},function(){
										$('#checkdiv').css("display","block");
										$('#sliderdiv').css("display","none");
						        	});
						        slider.init();
						    })
						</script> 
                    </div>
                    
                    <div class="form-group col-md-12" id="checkdiv">
                    	<button type="button" id="checkLogin" class="btn btn-primary col-md-6 col-md-offset-3 loginButton">登录</button>
					</div>
					
					<div class="form-group col-md-12 text-center" id="checkdiv">
						<c:choose>
							 	<c:when test="${SPRING_SECURITY_LAST_EXCEPTION.message == 'Bad credentials'}">
									<span style="color: red;">密码错误</span>
								</c:when>
						 		<c:otherwise>
						 			<span style="color: red;">${SPRING_SECURITY_LAST_EXCEPTION.message}</span>
						 		</c:otherwise>
						</c:choose>
					</div>
                    
                </form>

            </div>
        </div>
        <div class="row login_footer">
            <div class="col col-md-12">
                <p>管理和技术支持：中石化第四建设有限公司</p>
                <p>电话：022-63863791</p>
            </div>

        </div>

    </div>
		<script src="${emms}/js/respond.js" type="text/javascript" ></script>
		<script src="${emms}/js/jquery.validate.js" type="text/javascript" ></script>
		<script src="${emms}/js/loginScript.js" charset="UTF-8"></script>	
		<script src="${emms}/js/bootstrap/bootstrap.min.js" type="text/javascript"></script>
		<script src="${emms}/js/placeholder.js" type="text/javascript"></script>
		<script type="text/javascript">
			
			$(document).keydown(function(e){
				if(e.keyCode==13 || e.keyCode==17 || e.keyCode==18){
					$('#checkLogin').trigger("click");
				}
			});
			
			$('input').keyup(function(e){
				var f = false;
				if($('input').eq(0).val()!="" && $('input').eq(1).val()!=""){
					console.log("is run");
					$('#sliderdiv').css("display","block");
				}
			});

			$('input').placeholder();
			function checkParent(){
			    if(window.parent.length>0){ 
			        window.parent.location="${emms}/login.jsp"; 
			    }
				window.moveTo(0,0);
				window.resizeTo(screen.availWidth,screen.availHeight);
			}
		</script>

	</body>
</html>
