<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="InWarehouseDetail">
        <resultMap id="inWarehouseDetailMap" type="InWarehouseDetail">
        <id column="in_detail_id"  property="inDetailId"></id>
        <result column="in_detail_code"  property="inDetailCode"></result>
        <result column="supplier_id"  property="supplierId"></result>
        <result column="supplier_name"  property="supplierName"></result>
        <result column="in_detail_state"  property="inDetailState"></result>
        <result column="in_warehouse_id"  property="inWarehouseId"></result>
        <result column="in_warehouse_code"  property="inWarehouseCode"></result>
        <result column="create_time" property="createTime"/>
        <result column="create_user_id" property="createUserId"/>
        <result column="create_user_name" property="createUserName"/>
        <result column="in_worker" property="inWorker"/>
        <result column="wbs_id" property="wbsId"/>
        <result column="wbs_code" property="wbsCode"/>
        <result column="materials_id" property="materialsId"/>
        <result column="materials_code" property="materialsCode"/>
        <result column="materials_describe" property="materialsDescribe"/>
        <result column="additional_1" property="additional1"/>
        <result column="additional_2" property="additional2"/>
        <result column="additional_3" property="additional3"/>
        <result column="additional_4" property="additional4"/>
        <result column="materials_unit_main" property="materialsUnitMain"  />
        <result column="production_date" property="productionDate"/>
        <result column="bzq" property="bzq"/>
        <result column="purchase_count" property="purchaseCount"/>
        <result column="delivery_count" property="deliveryCount"/>
        <result column="this_delivery_count" property="thisDeliveryCount"/>
        <result column="dianshou_count" property="dianshouCount"/>
        <result column="qualified_count" property="qualifiedCount"/>
        <result column="unqualified_count" property="unqualifiedCount"/>
        <result column="visual_inspection" property="visualInspection"/>
        <result column="review" property="review"/>
        <result column="in_warehouse_count" property="inWarehouseCount"/>
         <result column="zhijian_id"  property="zhijianId"/>
         <result column="zhijian_code"  property="zhijianCode"/>
         <result column="order_id"  property="orderId"/>
         <result column="order_code"  property="orderCode"/>
         <result column="storagelocation_id"  property="storagelocationId"/>
         <result column="storagelocation_code"  property="storagelocationCode"/>
         <result column="warehouse_id"  property="warehouseId"/>
         <result column="reservoirarea_id"  property="reservoirareaId"/>

</resultMap>
        <delete id="delete" parameterType="string">
                delete from RU_IN_WAREHOUSE_DETAIL where in_warehouse_id = #{inWarehouseId}
        </delete>

        <!-- 根据条件查询条目 -->
        <select id="selectByCondition" resultMap="inWarehouseDetailMap" parameterType="map">
                select *
                from (SELECT a.in_warehouse_id,
                a.zhijian_id,
                a.zhijian_code,
                a.materials_id,
                a.materials_code,
                a.materials_describe,
                a.additional_1,
                a.additional_2,
                a.additional_3,
                a.additional_4,
                a.wbs_id,
                a.wbs_code,
                a.materials_unit_main,
                a.production_date,
                a.bzq,
                a.purchase_count,
                a.delivery_count,
                a.dianshou_count,
                a.qualified_count,
                a.unqualified_count,
                a.visual_inspection,
                a.review,
                a.in_warehouse_count,
                a.order_id,
                a.order_code,
                storagelocation_code,
                storagelocation_id,
                warehouse_id,
                reservoirarea_id
                FROM RU_IN_WAREHOUSE_DETAIL a
                LEFT JOIN RU_IN_WAREHOUSE b ON b.in_warehouse_id=a.in_warehouse_id
                <where>
                        <if test="InWarehouseDetailCondition!=null">
                                <if test="InWarehouseDetailCondition.inWarehouseId!=null and InWarehouseDetailCondition.inWarehouseId!=''" >
                                        AND a.in_warehouse_id=#{InWarehouseDetailCondition.inWarehouseId}
                                </if>
                                <if test="InWarehouseDetailCondition.zhijianCode!=null and InWarehouseDetailCondition.zhijianCode!=''" >
                                        AND zhijian_code=#{InWarehouseDetailCondition.zhijianCode}
                                </if>
                                <if test="InWarehouseDetailCondition.materialsId!=null and InWarehouseDetailCondition.materialsId!=''" >
                                        AND materials_id=#{InWarehouseDetailCondition.materialsId}
                                </if>
                                <if test="InWarehouseDetailCondition.materialsCode!=null and InWarehouseDetailCondition.materialsCode!=''" >
                                        AND materials_code=#{InWarehouseDetailCondition.materialsCode}
                                </if>
                                <if test="InWarehouseDetailCondition.materialsDescribe!=null and InWarehouseDetailCondition.materialsDescribe!=''" >
                                        AND materials_describe=#{InWarehouseDetailCondition.materialsDescribe}
                                </if>
                                <if test="InWarehouseDetailCondition.additional1!=null and InWarehouseDetailCondition.additional1!=''" >
                                        AND additional_1=#{InWarehouseDetailCondition.additional1}
                                </if>
                                <if test="InWarehouseDetailCondition.additional2!=null and InWarehouseDetailCondition.additional2!=''" >
                                        AND additional_2=#{InWarehouseDetailCondition.additional2}
                                </if>
                                <if test="InWarehouseDetailCondition.additional3!=null and InWarehouseDetailCondition.additional3!=''" >
                                        AND additional_3=#{InWarehouseDetailCondition.additional3}
                                </if>
                                <if test="InWarehouseDetailCondition.additional4!=null and InWarehouseDetailCondition.additional4!=''" >
                                        AND additional_4=#{InWarehouseDetailCondition.additional4}
                                </if>
                                <if test="InWarehouseDetailCondition.wbsId!=null and InWarehouseDetailCondition.wbsId!=''" >
                                        AND wbs_id=#{InWarehouseDetailCondition.wbsId}
                                </if>
                                <if test="InWarehouseDetailCondition.wbsCode!=null and InWarehouseDetailCondition.wbsCode!=''" >
                                        AND wbs_code=#{InWarehouseDetailCondition.wbsCode}
                                </if>
                                <if test="InWarehouseDetailCondition.materialsUnitMain!=null and InWarehouseDetailCondition.materialsUnitMain!=''" >
                                        AND materials_unit_main=#{InWarehouseDetailCondition.materialsUnitMain}
                                </if>
                                <if test="InWarehouseDetailCondition.productionDate!=null and InWarehouseDetailCondition.productionDate!=''" >
                                        AND production_date=#{InWarehouseDetailCondition.productionDate}
                                </if>
                                <if test="InWarehouseDetailCondition.bzq!=null and InWarehouseDetailCondition.bzq!=''" >
                                        AND bzq=#{InWarehouseDetailCondition.bzq}
                                </if>
                                <if test="InWarehouseDetailCondition.purchaseCount!=null and InWarehouseDetailCondition.purchaseCount!=''" >
                                        AND purchase_count=#{InWarehouseDetailCondition.purchaseCount}
                                </if>
                                <if test="InWarehouseDetailCondition.deliveryCount!=null and InWarehouseDetailCondition.deliveryCount!=''" >
                                        AND delivery_count=#{InWarehouseDetailCondition.deliveryCount}
                                </if>
                                <if test="InWarehouseDetailCondition.dianshouCount!=null and InWarehouseDetailCondition.dianshouCount!=''" >
                                        AND dianshou_count=#{InWarehouseDetailCondition.dianshouCount}
                                </if>
                                <if test="InWarehouseDetailCondition.qualifiedCount!=null and InWarehouseDetailCondition.qualifiedCount!=''" >
                                        AND qualified_count=#{InWarehouseDetailCondition.qualifiedCount}
                                </if>
                                <if test="InWarehouseDetailCondition.unqualifiedCount!=null and InWarehouseDetailCondition.unqualifiedCount!=''" >
                                        AND unqualified_count=#{InWarehouseDetailCondition.unqualifiedCount}
                                </if>
                                <if test="InWarehouseDetailCondition.visualInspection!=null and InWarehouseDetailCondition.visualInspection!=''" >
                                        AND visual_inspection=#{InWarehouseDetailCondition.visualInspection}
                                </if>
                                <if test="InWarehouseDetailCondition.review!=null and InWarehouseDetailCondition.review!=''" >
                                        AND review=#{InWarehouseDetailCondition.review}
                                </if>
                                <if test="InWarehouseDetailCondition.inWarehouseCount!=null and InWarehouseDetailCondition.inWarehouseCount!=''" >
                                        AND in_warehouse_count=#{InWarehouseDetailCondition.inWarehouseCount}
                                </if>
                                <if test="InWarehouseDetailCondition.orderCode!=null and InWarehouseDetailCondition.orderCode!=''" >
                                        AND order_code=#{InWarehouseDetailCondition.orderCode}
                                </if>
                                <if test="InWarehouseDetailCondition.storagelocationCode!=null and InWarehouseDetailCondition.storagelocationCode!=''" >
                                        AND storagelocation_code=#{InWarehouseDetailCondition.storagelocationCode}
                                </if>
                                <if test="InWarehouseDetailCondition.storagelocationId!=null and InWarehouseDetailCondition.storagelocationId!=''" >
                                        AND storagelocation_id=#{InWarehouseDetailCondition.storagelocationId}
                                </if>
                                <if test="InWarehouseDetailCondition.warehouseId!=null and InWarehouseDetailCondition.warehouseId!=''" >
                                        AND warehouse_id=#{InWarehouseDetailCondition.warehouseId}
                                </if>
                                <if test="InWarehouseDetailCondition.reservoirareaId!=null and InWarehouseDetailCondition.reservoirareaId!=''" >
                                        AND reservoirarea_id=#{InWarehouseDetailCondition.reservoirareaId}
                                </if>
                                <if test="InWarehouseDetailCondition.inWarehouseDetailList != null and InWarehouseDetailCondition.inWarehouseDetailList.size>0">
                                        and
                                        a.in_warehouse_id in
                                        <foreach collection="InWarehouseDetailCondition.inWarehouseDetailList" item="item" open="(" close=")"
                                                 separator=",">
                                                #{item}
                                        </foreach>
                                </if>
                        </if>
                </where>

                )
                </select>

        <!-- 根据条件查询条目数 -->
        <select id="countByCondition" resultType="int" parameterType="map">
                 select count(*)
                 FROM RU_IN_WAREHOUSE_DETAIL a
                LEFT JOIN RU_IN_WAREHOUSE b ON a.in_warehouse_id=b.in_warehouse_id
                <where>
                        1=1
                        <if test="InWarehouseDetailCondition!=null">
                                <if test="InWarehouseDetailCondition.zhijianCode!=null and InWarehouseDetailCondition.zhijianCode!=''" >
                                        AND zhijian_code=#{InWarehouseDetailCondition.zhijianCode}
                                </if>
                                <if test="InWarehouseDetailCondition.materialsId!=null and InWarehouseDetailCondition.materialsId!=''" >
                                        AND materials_id=#{InWarehouseDetailCondition.materialsId}
                                </if>
                                <if test="InWarehouseDetailCondition.materialsCode!=null and InWarehouseDetailCondition.materialsCode!=''" >
                                        AND materials_code=#{InWarehouseDetailCondition.materialsCode}
                                </if>
                                <if test="InWarehouseDetailCondition.materialsDescribe!=null and InWarehouseDetailCondition.materialsDescribe!=''" >
                                        AND materials_describe=#{InWarehouseDetailCondition.materialsDescribe}
                                </if>
                                <if test="InWarehouseDetailCondition.additional1!=null and InWarehouseDetailCondition.additional1!=''" >
                                        AND additional_1=#{InWarehouseDetailCondition.additional1}
                                </if>
                                <if test="InWarehouseDetailCondition.additional2!=null and InWarehouseDetailCondition.additional2!=''" >
                                        AND additional_2=#{InWarehouseDetailCondition.additional2}
                                </if>
                                <if test="InWarehouseDetailCondition.additional3!=null and InWarehouseDetailCondition.additional3!=''" >
                                        AND additional_3=#{InWarehouseDetailCondition.additional3}
                                </if>
                                <if test="InWarehouseDetailCondition.additional4!=null and InWarehouseDetailCondition.additional4!=''" >
                                        AND additional_4=#{InWarehouseDetailCondition.additional4}
                                </if>
                                <if test="InWarehouseDetailCondition.wbsId!=null and InWarehouseDetailCondition.wbsId!=''" >
                                        AND wbs_id=#{InWarehouseDetailCondition.wbsId}
                                </if>
                                <if test="InWarehouseDetailCondition.wbsCode!=null and InWarehouseDetailCondition.wbsCode!=''" >
                                        AND wbs_code=#{InWarehouseDetailCondition.wbsCode}
                                </if>
                                <if test="InWarehouseDetailCondition.materialsUnitMain!=null and InWarehouseDetailCondition.materialsUnitMain!=''" >
                                        AND materials_unit_main=#{InWarehouseDetailCondition.materialsUnitMain}
                                </if>
                                <if test="InWarehouseDetailCondition.productionDate!=null and InWarehouseDetailCondition.productionDate!=''" >
                                        AND production_date=#{InWarehouseDetailCondition.productionDate}
                                </if>
                                <if test="InWarehouseDetailCondition.bzq!=null and InWarehouseDetailCondition.bzq!=''" >
                                        AND bzq=#{InWarehouseDetailCondition.bzq}
                                </if>
                                <if test="InWarehouseDetailCondition.purchaseCount!=null and InWarehouseDetailCondition.purchaseCount!=''" >
                                        AND purchase_count=#{InWarehouseDetailCondition.purchaseCount}
                                </if>
                                <if test="InWarehouseDetailCondition.deliveryCount!=null and InWarehouseDetailCondition.deliveryCount!=''" >
                                        AND delivery_count=#{InWarehouseDetailCondition.deliveryCount}
                                </if>
                                <if test="InWarehouseDetailCondition.dianshouCount!=null and InWarehouseDetailCondition.dianshouCount!=''" >
                                        AND dianshou_count=#{InWarehouseDetailCondition.dianshouCount}
                                </if>
                                <if test="InWarehouseDetailCondition.qualifiedCount!=null and InWarehouseDetailCondition.qualifiedCount!=''" >
                                        AND qualified_count=#{InWarehouseDetailCondition.qualifiedCount}
                                </if>
                                <if test="InWarehouseDetailCondition.unqualifiedCount!=null and InWarehouseDetailCondition.unqualifiedCount!=''" >
                                        AND unqualified_count=#{InWarehouseDetailCondition.unqualifiedCount}
                                </if>
                                <if test="InWarehouseDetailCondition.visualInspection!=null and InWarehouseDetailCondition.visualInspection!=''" >
                                        AND visual_inspection=#{InWarehouseDetailCondition.visualInspection}
                                </if>
                                <if test="InWarehouseDetailCondition.review!=null and InWarehouseDetailCondition.review!=''" >
                                        AND review=#{InWarehouseDetailCondition.review}
                                </if>
                                <if test="InWarehouseDetailCondition.inWarehouseCount!=null and InWarehouseDetailCondition.inWarehouseCount!=''" >
                                        AND in_warehouse_count=#{InWarehouseDetailCondition.inWarehouseCount}
                                </if>
                                <if test="InWarehouseDetailCondition.storagelocationCode!=null and InWarehouseDetailCondition.storagelocationCode!=''" >
                                        AND storagelocation_code=#{InWarehouseDetailCondition.storagelocationCode}
                                </if>
                                <if test="InWarehouseDetailCondition.storagelocationId!=null and InWarehouseDetailCondition.storagelocationId!=''" >
                                        AND storagelocation_id=#{InWarehouseDetailCondition.storagelocationId}
                                </if>
                                <if test="InWarehouseDetailCondition.warehouseId!=null and InWarehouseDetailCondition.warehouseId!=''" >
                                        AND warehouse_id=#{InWarehouseDetailCondition.warehouseId}
                                </if>
                                <if test="InWarehouseDetailCondition.reservoirareaId!=null and InWarehouseDetailCondition.reservoirareaId!=''" >
                                        AND reservoirarea_id=#{InWarehouseDetailCondition.reservoirareaId}
                                </if>
                                <if test="InWarehouseDetailCondition.inWarehouseDetailList != null and InWarehouseDetailCondition.inWarehouseDetailList.size>0">
                                        and
                                        in_Warehouse_id in
                                        <foreach collection="InWarehouseDetailCondition.inWarehouseDetailList" item="item" open="(" close=")"
                                                 separator=",">
                                                #{item}
                                        </foreach>
                                </if>
                        </if>
                </where>
        </select>

        <!-- 批量插入入库明细表 -->
        <insert id="insertList" parameterType="java.util.List" useGeneratedKeys="false">
                 insert into RU_IN_WAREHOUSE_DETAIL
                 (
                in_warehouse_id,
                in_detail_id,
                zhijian_id,
                zhijian_code,
                materials_id,
                materials_code,
                materials_describe,
                additional_1,
                additional_2,
                additional_3,
                additional_4,
                wbs_id,
                wbs_code,
                materials_unit_main,
                production_date,
                bzq,
                purchase_count,
                delivery_count,
                dianshou_count,
                qualified_count,
                unqualified_count,
                visual_inspection,
                review,
                in_warehouse_count,
                order_id,
                order_code,
                storagelocation_code,
                storagelocation_id,
                warehouse_id,
                reservoirarea_id
                )
                 SELECT A.*
                FROM(
                <foreach collection="list" item="item" index="index" separator="UNION ALL">(SELECT
                        #{item.inWarehouseId} in_warehouse_id,
                        #{item.inDetailId} in_detail_id,
                        #{item.zhijianId} zhijian_id,
                        #{item.zhijianCode} zhijian_code,
                        #{item.materialsId}  materials_id,
                        #{item.materialsCode} materials_code,
                        #{item.materialsDescribe} materials_describe,
                        #{item.additional1} additional_1,
                        #{item.additional2} additional_2,
                        #{item.additional3} additional_3,
                        #{item.additional4} additional_4,
                        #{item.wbsId} wbs_id,
                        #{item.wbsCode} wbs_code,
                        #{item.materialsUnitMain} materials_unit_main,
                        #{item.productionDate,jdbcType=TIMESTAMP} production_date,
                        #{item.bzq,jdbcType=TIMESTAMP} bzq,
                        #{item.purchaseCount,jdbcType=DECIMAL} purchase_count,
                        #{item.deliveryCount,jdbcType=DECIMAL} delivery_count,
                        #{item.dianshouCount,jdbcType=DECIMAL} dianshou_count,
                        #{item.qualifiedCount,jdbcType=DECIMAL} qualified_count,
                        #{item.unqualifiedCount,jdbcType=DECIMAL} unqualified_count,
                        #{item.visualInspection} visual_inspection,
                        #{item.review} review,
                        #{item.inWarehouseCount,jdbcType=DECIMAL} in_warehouse_count,
                        #{item.orderId} order_id,
                        #{item.orderCode} order_code,
                        #{item.storagelocationCode} storagelocation_code,
                        #{item.storagelocationId} storagelocation_id,
                        #{item.warehouseId} warehouse_id,
                        #{item.reservoirareaId} reservoirarea_id
                        FROM dual
                        )
                </foreach>
                ) A
        </insert>

        <!-- 更新一个实体 -->
        <update id="update" parameterType="InWarehouseDetail" >
                 update RU_IN_WAREHOUSE_DETAIL
                 <set>
                         <if test="InWarehouseDetail!=null">
                                 <if test="zhijianCode!=null and zhijianCode!=''" >
                                         AND zhijian_code=#{zhijianCode}
                                 </if>

                                 <if test="materialsId!=null and materialsId!=''" >
                                         AND materials_id=#{materialsId}
                                 </if>
                                 <if test="materialsCode!=null and materialsCode!=''" >
                                         AND materials_code=#{materialsCode}
                                 </if>
                                 <if test="materialsDescribe!=null and materialsDescribe!=''" >
                                         AND materials_describe=#{materialsDescribe}
                                 </if>
                                 <if test="additional1!=null and additional1!=''" >
                                         AND additional_1=#{additional1}
                                 </if>
                                 <if test="additional2!=null and additional2!=''" >
                                         AND additional_2=#{additional2}
                                 </if>
                                 <if test="additional3!=null and additional3!=''" >
                                         AND additional_3=#{additional3}
                                 </if>
                                 <if test="additional4!=null and additional4!=''" >
                                         AND additional_4=#{additional4}
                                 </if>
                                 <if test="wbsId!=null and wbsId!=''" >
                                         AND wbs_id=#{wbsId}
                                 </if>
                                 <if test="wbsCode!=null and wbsCode!=''" >
                                         AND wbs_code=#{wbsCode}
                                 </if>
                                 <if test="materialsUnitMain!=null and materialsUnitMain!=''" >
                                         AND materials_unit_main=#{materialsUnitMain}
                                 </if>
                                 <if test="productionDate!=null and productionDate!=''" >
                                         AND production_date=#{productionDate}
                                 </if>
                                 <if test="bzq!=null and bzq!=''" >
                                         AND bzq=#{bzq}
                                 </if>
                                 <if test="purchaseCount!=null and purchaseCount!=''" >
                                         AND purchase_count=#{purchaseCount}
                                 </if>
                                 <if test="deliveryCount!=null and deliveryCount!=''" >
                                         AND delivery_count=#{deliveryCount}
                                 </if>
                                 <if test="dianshouCount!=null and dianshouCount!=''" >
                                         AND dianshou_count=#{dianshouCount}
                                 </if>
                                 <if test="qualifiedCount!=null and qualifiedCount!=''" >
                                         AND qualified_count=#{qualifiedCount}
                                 </if>
                                 <if test="unqualifiedCount!=null and unqualifiedCount!=''" >
                                         AND unqualified_count=#{unqualifiedCount}
                                 </if>
                                 <if test="visualInspection!=null and visualInspection!=''" >
                                         AND visual_inspection=#{visualInspection}
                                 </if>
                                 <if test="review!=null and review!=''" >
                                         AND review=#{review}
                                 </if>
                                 <if test="inWarehouseCount!=null and inWarehouseCount!=''" >
                                         AND in_warehouse_count=#{inWarehouseCount}
                                 </if>
                                 <if test="orderCode!=null and orderCode!=''" >
                                         AND order_code=#{orderCode}
                                 </if>
                                 <if test="storagelocationCode!=null and storagelocationCode!=''" >
                                         AND storagelocation_code=#{storagelocationCode}
                                 </if>
                                 <if test="storagelocationId!=null and storagelocationId!=''" >
                                         AND storagelocation_id=#{storagelocationId}
                                 </if>
                                 <if test="warehouseId!=null and warehouseId!=''" >
                                         AND warehouse_id=#{warehouseId}
                                 </if>
                                 <if test="reservoirareaId!=null and reservoirareaId!=''" >
                                         AND reservoirarea_id=#{reservoirareaId}
                                 </if>
                         </if>
                 </set>
        </update>

        <select id="selectByInWarehouseId" resultMap="inWarehouseDetailMap" parameterType="string">
                select *
                FROM RU_IN_WAREHOUSE_DETAIL
                where
                in_warehouse_id = #{inWarehouseId}
        </select>

</mapper>