<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ReceiptPacking">
    <resultMap type="ReceiptPacking" id="receiptPackingMap">
        <id column="packing_id" property="packingId"/>
        <result column="receipt_id" property="receiptId"/>
        <result column="packing_no" property="packingNo"/>
        <result column="packing_size" property="packingSize"/>
        <result column="packing_weight" property="packingWeight"/>
        <result column="parent_id" property="_parentId"/>
        <result column="packing_type" property="packingType"/>
        <result column="dianshou_type" property="dianshouType"/>
        <result column="is_dianshou" property="isDianshou"/>
        <result column="storage_id" property="storageId"/>
        <result column="storage_code" property="storageCode"/>
        <result column="delivery_packing_id" property="deliveryPackingId"/>
        <result column="dianshou_count" property="dianshouCount"/>
    </resultMap>
    <insert id="insertList" parameterType="java.util.List" useGeneratedKeys="false">
        insert into ru_packing
        (packing_id,receipt_id,
        packing_no,packing_size,
        packing_weight,parent_id,
        packing_type,dianshou_type,
        is_dianshou,storage_id,
        storage_code,delivery_packing_id,
        dianshou_count)
        SELECT A.*
        FROM(
        <foreach collection="list" item="item" index="index" separator="UNION ALL">
            (SELECT
            #{item.packingId} packing_id,#{item.receiptId} receipt_id,
            #{item.packingNo} packing_no,#{item.packingSize} packing_size,
            #{item.packingWeight} packing_weight,#{item._parentId} parent_id,
            #{item.packingType} packing_type,#{item.dianshouType} dianshou_type,
            #{item.isDianshou} is_dianshou,#{item.storageId} storage_id,
            #{item.storageCode} storage_code,#{item.deliveryPackingId} delivery_packing_id,
            #{item.dianshouCount ,jdbcType=DECIMAL} dianshou_count
            FROM dual)
        </foreach>
        )A
    </insert>
    <select id="selectByReceiptId" resultMap="receiptPackingMap">
        select * from ru_packing where receipt_id=#{receiptId}
</select>
    <delete id="delete" parameterType="string">
        delete from ru_packing where receipt_id = #{receiptId}
    </delete>
</mapper>
