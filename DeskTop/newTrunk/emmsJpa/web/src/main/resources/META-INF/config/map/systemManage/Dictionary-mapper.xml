<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Dictionary">	
	<resultMap type="Dictionary" id="dictionaryMap">
		<id column="dictionary_id" property="dictionaryId"/>
		<result column="dictionary_code" property="dictionaryCode"/>
		<result column="dictionary_name" property="dictionaryName"/>
		<result column="is_del" property="isDel"/>
		<result column="parent_id" property="parentId"/>
		<result column="dictionary_type" property="dictionaryType"/>
	</resultMap>
	<select id="selectAll" resultMap="dictionaryMap">
		select * from SYS_DICTIONARY where is_del = '1'
	</select>
	<select id="selectAllDictionary" resultMap="dictionaryMap" parameterType="string" >
		select * from SYS_DICTIONARY where is_del = '1' and dictionary_type = #{dictionaryType}
	</select>
	<select id="selectByCondition" resultMap="dictionaryMap" parameterType="map">
		select * from (
			select dic.*,ROW_NUMBER() OVER(order by dic.dictionary_id) r from SYS_DICTIONARY dic 
			<where>
				dic.is_del = '1'
				<if test="Dictionary!=null">
					<if test="Dictionary.parentId!=null and Dictionary.parentId!=''">and dic.parent_id = #{Dictionary.parentId}</if>
					<if test="Dictionary.dictionaryType!=null ">and dic.dictionary_type = #{Dictionary.dictionaryType}</if>
				</if>
			</where>
		) s where s.r between #{page.startPos} and ((#{page.pageSize}+#{page.startPos})-1)
	</select>
	<select id="countByCondition" resultType="int" parameterType="map">
		select count(*) from SYS_DICTIONARY dic
		<where>
			 dic.is_del = '1'
			<if test="Dictionary!=null">
				<if test="Dictionary.parentId!=null and Dictionary.parentId!=''">and dic.parent_id = #{Dictionary.parentId}</if>
				<if test="Dictionary.dictionaryType!=null ">and dic.dictionary_type = #{Dictionary.dictionaryType}</if>
				<if test="Dictionary.dictionaryCode!=null">and dic.dictionary_code = #{Dictionary.dictionaryCode}</if>
			</if>

		</where>
	</select>
	<select id="selectByPk" resultMap="dictionaryMap" parameterType="string">
		select * from SYS_DICTIONARY dic where dic.dictionary_id = #{dictionaryId} and dic.is_del = '1'
	</select> 
	<select id="selectByCode" resultMap="dictionaryMap" parameterType="string">
		select * from SYS_DICTIONARY dic where dic.dictionary_code = #{dictionaryCode} and dic.is_del = '1'
	</select>
	<insert id="insert" parameterType="Dictionary" useGeneratedKeys="false">
		insert into SYS_DICTIONARY (
			dictionary_id,dictionary_code,dictionary_name,is_del,parent_id,dictionary_type
		) values (
			#{dictionaryId},#{dictionaryCode},#{dictionaryName},#{isDel},#{parentId},#{dictionaryType}
		)
	</insert>
	<update id="update" parameterType="Dictionary">
		update SYS_DICTIONARY 
		<set>   
			<if test="dictionaryCode!= null and dictionaryCode!=''">dictionary_code = #{dictionaryCode},</if>
			<if test="dictionaryName!= null and dictionaryName!=''">dictionary_name = #{dictionaryName},</if>
			<if test="isDel!= null and isDel!=''">is_del = #{isDel},</if>
			<if test="parentId!= null and parentId!=''">parent_id = #{parentId}</if>
		</set>
		where dictionary_id = #{dictionaryId}
	</update> 
	<delete id="delete" parameterType="string">
		update SYS_DICTIONARY set is_del = '0' where dictionary_id = #{dictionaryId}
	</delete>
	<select id="selectByParentId" resultMap="dictionaryMap" parameterType="string">
		select * from SYS_DICTIONARY where is_del != '0' and parent_id = #{dictionaryId} 
	</select>
</mapper>